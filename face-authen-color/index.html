<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-eval' 'unsafe-inline' https: data:; worker-src blob:">
  <meta name="description" content="Vanilla JS demo" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../style.css" />
</head>
<body>
<noscript>You need to enable JavaScript to run this app.</noscript>
<h2>Extract ID Info & Liveness detection</h2>
<div id="container"></div>

<div id="content">
  <div style="margin-bottom: 10px">
    Language
    <select id="select-lang" onchange="onSelectLang()">
      <option value="vi" selected>vi</option>
      <option value="en">en</option>
    </select>
  </div>

  <div style="margin-bottom: 10px" id="keys-input-placeholder">
  </div>

  <hr />
  <h4>Face liveness with color</h4>

  <label for="key-length">Key1 length: </label>
  <input id="key-length" value="12" />
  <br />
  <label for="key-length">Key2: </label>
  <input id="key-duration" value="250" />
  <br /><br />
  <button onclick="startFaceAuthen()">Start</button>

  </div>


<script src="https://unpkg.com/jsqr@1.4.0/dist/jsQR.js"></script>
<script src="../qr-scanner-for-input-keys.js"></script>
<script src="../keys-input.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
<script src="https://unpkg.com/@tsocial/trustvision-sdk@2.10.1/dist/trustvision-sdk.umd.js"></script>
<script src="./tvweb-sdk.standalone.min.js"></script>
<script>
  let listObjUrls = [];
  function onSelectLang() {
    const langEle = document.getElementById("select-lang");
    localStorage.setItem('lang', langEle.value);
    location.reload();
  }
  function createObjectURL(blob) {
    const objUrl = URL.createObjectURL(blob);
    listObjUrls.push(objUrl);
    return objUrl;
  }
  function revokeObjectURL() {
    if (listObjUrls.length === 0) return;
    listObjUrls.map((item) => URL.revokeObjectURL(item));
    listObjUrls = [];
  }
</script>
<script type="text/javascript">
  const lang = localStorage.getItem('lang');
  if (lang) {
    const langEle = document.getElementById("select-lang");
    langEle.value = lang;
  }
  const tv = new TVWebSDK.SDK({
    container: document.getElementById("container"),
    lang: lang || "vi",
    assetRoot: "https://unpkg.com/@tsocial/tvweb-sdk@latest/assets",
    enableAntiDebug: false,
  });
  window.tv = tv;
  tv.runPreloadEKYCResources();

  function startFaceAuthen() {
    const keyL = document.getElementById('key-length').value;
    const key2 = document.getElementById('key-duration').value;
    tv.faceAuthen({
      colorKeyLength: parseInt(keyL),
      splashDuration: parseInt(key2),
    });
  }

</script>
</body>
</html>
